{% extends "base.html" %}

{% block title %}Hist√≥rico Funcional de {{ aluno.user.nome_completo }}{% endblock %}

{% block content %}
<div class="content-header">
    <h1>Hist√≥rico Funcional</h1>
    <p>Registros de atividades, fun√ß√µes e processos para <strong>{{ aluno.user.nome_completo }}</strong>.</p>
</div>

{% if elogios %}
<div class="elogios-section" style="margin-bottom: 2rem;">
    <div class="section-header">
        <h3><span style="font-size: 1.5rem;">üéñÔ∏è</span> Elogios e Refer√™ncias Elogiosas</h3>
    </div>
    <div class="elogios-grid">
        {% for elogio in elogios %}
        <div class="elogio-card">
            <div class="elogio-date">{{ elogio.data_elogio.strftime('%d/%m/%Y') }}</div>
            <div class="elogio-content">
                <p>{{ elogio.descricao }}</p>
                <span class="elogio-points">+{{ "%.2f"|format(elogio.pontos) }} pontos na FADA</span>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

<div class="content-header" style="margin-top: 1rem;">
    <h2>Linha do Tempo (Fun√ß√µes e Puni√ß√µes)</h2>
</div>

<div class="table-container">
    {% if historico %}
        <div class="timeline">
            {% for evento in historico %}
            <div class="timeline-item">
                <div class="timeline-icon">
                    {% if 'Fun√ß√£o' in evento.tipo %}
                        <span title="Fun√ß√£o de Turma">‚≠ê</span>
                    {% elif 'Processo' in evento.tipo %}
                        <span title="Processo Disciplinar">‚öñÔ∏è</span>
                    {% else %}
                        <span title="Outro Evento">üìã</span>
                    {% endif %}
                </div>
                <div class="timeline-content">
                    <div class="timeline-header">
                        <span class="timeline-title">{{ evento.tipo }}</span>
                        <span class="timeline-date">
                            {{ evento.data_inicio.strftime('%d/%m/%Y') }}
                            {% if evento.data_fim %}
                                a {{ evento.data_fim.strftime('%d/%m/%Y') }}
                            {% endif %}
                        </span>
                    </div>
                    <p class="timeline-description">{{ evento.descricao }}</p>
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-state">
            <div class="empty-icon">üìã</div>
            <h2>Nenhum Evento Funcional</h2>
            <p>N√£o h√° registros de puni√ß√µes ou fun√ß√µes de chefia para este aluno.</p>
        </div>
    {% endif %}

    <div class="form-actions">
        <a href="{{ url_for('aluno.listar_alunos') }}" class="btn btn-secondary">Voltar para a Lista de Alunos</a>
    </div>
</div>

<style>
/* Estilos da Timeline (Mantidos) */
.timeline { position: relative; padding: 1rem 0; }
.timeline-item { display: flex; gap: 1.5rem; position: relative; padding-bottom: 2rem; }
.timeline-item:not(:last-child)::before { content: ''; position: absolute; left: 24px; top: 50px; bottom: -1rem; width: 2px; background-color: var(--color-border); }
.timeline-icon { width: 50px; height: 50px; border-radius: 50%; background-color: var(--color-background); border: 2px solid var(--color-border); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; z-index: 1; }
.timeline-content { flex: 1; }
.timeline-header { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 0.5rem; }
.timeline-title { font-weight: bold; font-size: 1.1rem; }
.timeline-date { font-size: 0.85rem; color: var(--color-text-muted); }
.timeline-description { margin: 0; }

/* Novos Estilos para Elogios */
.elogios-grid { display: grid; grid-template-columns: 1fr; gap: 1rem; }
.elogio-card { 
    background-color: #f0fdf4; 
    border: 1px solid #bbf7d0; 
    border-radius: 8px; 
    padding: 1rem; 
    display: flex; 
    gap: 1rem;
    align-items: flex-start;
}
.elogio-date { 
    font-weight: bold; 
    color: #15803d; 
    min-width: 90px;
}
.elogio-points {
    display: inline-block;
    margin-top: 0.5rem;
    font-size: 0.8rem;
    background-color: #dcfce7;
    color: #166534;
    padding: 2px 8px;
    border-radius: 12px;
    font-weight: 600;
}
</style>
{% endblock %}