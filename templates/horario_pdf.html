<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Quadro Horário - {{ pelotao_selecionado }}</title>
    <style>
        @page {
            size: A4 landscape;
            margin: 0.7cm;
        }
        body {
            font-family: 'Inter', sans-serif;
            font-size: 8pt;
            color: #333;
        }
        .header { text-align: center; margin-bottom: 15px; border-bottom: 1px solid #ccc; padding-bottom: 8px; }
        .header h1 { margin: 0; font-size: 15pt; }
        .header p { margin: 0; font-size: 10pt; color: #555; }
        table { width: 100%; border-collapse: collapse; table-layout: fixed; }
        th, td { border: 1px solid #ccc; padding: 4px; text-align: center; word-wrap: break-word; vertical-align: middle; }
        th { background-color: #f2f2f2; font-weight: bold; }
        .header-tempo { width: 8%; }
        .cell-tempo { font-weight: bold; }
        .cell-tempo span { display: block; font-weight: normal; font-size: 0.8em; }
        .disciplina-title { font-weight: bold; font-size: 1.1em; display: block; }
        .instrutor-name, .slot-observacao { font-size: 0.9em; color: #444; display: block; }
        .slot-observacao { font-style: italic; }
        .weekend-table { margin-top: 20px; }
        /* Novo estilo para o intervalo no PDF */
        tr.break-after > td {
            border-bottom: 2px solid #333;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Quadro Horário</h1>
        <p>Turma: {{ pelotao_selecionado }} | Semana: {{ semana_selecionada.nome }} ({{ semana_selecionada.data_inicio.strftime('%d/%m/%Y') }} a {{ semana_selecionada.data_fim.strftime('%d/%m/%Y') }})</p>
    </div>

    <table>
        <thead>
            <tr>
                <th class="header-tempo">Horário</th>
                <th>Segunda<br><small>({{ datas_semana.segunda }})</small></th>
                <th>Terça<br><small>({{ datas_semana.terca }})</small></th>
                <th>Quarta<br><small>({{ datas_semana.quarta }})</small></th>
                <th>Quinta<br><small>({{ datas_semana.quinta }})</small></th>
                <th>Sexta<br><small>({{ datas_semana.sexta }})</small></th>
            </tr>
        </thead>
        <tbody>
            {% set tempos = [
                ("1º", "07:30-08:15"), ("2º", "08:15-09:00"), ("3º", "09:00-09:45"),
                ("4º", "10:00-10:45"), ("5º", "10:45-11:30"), ("6º", "11:30-12:15"),
                ("7º", "13:45-14:30"), ("8º", "14:30-15:15"), ("9º", "15:15-16:00"),
                ("10º", "16:15-17:00"), ("11º", "17:00-17:45"), ("12º", "17:45-18:30"),
                ("13º", "18:30-19:15"), ("14º", "19:15-20:00"), ("15º", "20:00-20:45")
            ] %}
            {% for row_idx in range(15) %}
                {% set periodo_num = row_idx + 1 %}
                {% if (periodo_num <= 12) or 
                      (periodo_num == 13 and semana_selecionada.mostrar_periodo_13) or
                      (periodo_num == 14 and semana_selecionada.mostrar_periodo_14) or
                      (periodo_num == 15 and semana_selecionada.mostrar_periodo_15) %}
                <tr class="{% if periodo_num in [3, 6, 9] %}break-after{% endif %}">
                    <td class="cell-tempo"><strong>{{ tempos[row_idx][0] }}</strong><span>{{ tempos[row_idx][1] }}</span></td>
                    {% for col_idx in range(5) %}
                        {% set aula = horario_matrix[row_idx][col_idx] %}
                        {% if aula != 'SKIP' %}
                            <td rowspan="{{ aula.duracao if not aula.is_disposicao else 1 }}">
                                <div class="slot-content">
                                    <span class="disciplina-title">{{ aula.materia }}</span>
                                    {% if aula.instrutor %}<span class="instrutor-name">{{ aula.instrutor }}</span>{% endif %}
                                    {% if aula.observacao %}<span class="slot-observacao">{{ aula.observacao }}</span>{% endif %}
                                </div>
                            </td>
                        {% endif %}
                    {% endfor %}
                </tr>
                {% endif %}
            {% endfor %}
        </tbody>
    </table>
</body>
</html>