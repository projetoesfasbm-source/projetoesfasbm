{% extends "base.html" %}

{% block title %}Definir nova senha com código{% endblock %}

{% block navbar_content %}{% endblock %}

{% block content %}
<div class="auth-page-container">
    <div class="auth-card" style="max-width: 450px;">
        <div class="card-logo-container">
            <img src="{{ url_for('static', filename='img/brasao.png') }}" alt="Brasão da Escola">
        </div>
        <h2>Definir nova senha com código</h2>
        <p style="font-size: 0.9rem; opacity: 0.8; margin-top: -15px; margin-bottom: 20px;">Informe sua Matrícula e o código de redefinição fornecido pela administração.</p>

        <form method="POST" action="{{ url_for('auth.set_new_with_token') }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

            <div class="form-group">
                <label for="matricula">Matrícula:</label>
                <input type="text" id="matricula" name="matricula" class="form-control"
                       pattern="[0-9]*" inputmode="numeric"
                       placeholder="Digite sua Matrícula" value="{{ form_data.get('matricula','') }}" required>
            </div>

            <div class="form-group">
                <label for="token">Código de Redefinição:</label>
                <input type="text" id="token" name="token" class="form-control" placeholder="Ex.: A7k3Z9Qp4L" required>
            </div>

            <div class="form-group">
                <label for="password">Nova Senha:</label>
                <input type="password" id="password" name="password" class="form-control" autocomplete="new-password" required>
            </div>
            <div class="form-group">
                <label for="password2">Confirmar Nova Senha:</label>
                <input type="password" id="password2" name="password2" class="form-control" autocomplete="new-password" required>
            </div>
            <div class="password-rules">
                <small>A senha deve conter pelo menos 8 caracteres, incluindo uma letra maiúscula, uma minúscula, um número e um caractere especial (!@#$%).</small>
            </div>

            <button type="submit" class="btn btn-primary">Salvar Nova Senha</button>
        </form>
        <div class="auth-link" style="margin-top: 1rem; display: flex; flex-direction: column; gap: 0.5rem;">
            <a href="{{ url_for('auth.login') }}">Voltar para o Login</a>
        </div>
    </div>
</div>
{% endblock %}